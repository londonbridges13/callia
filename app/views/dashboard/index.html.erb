<div class="row  border-bottom white-bg dashboard-header">
    <div class="col-sm-3">
      <%if current_user.name%>
        <h2>Welcome <%= current_user.name%></h2>
      <%end%>
        <div class="widget btn-success style1 lazur-bg col-xs-10">
            <div class="row vertical-align">
                <div class="col-xs-12 text-center">
                    <h2 class="font-bold no-margins">Clock Ins: <%=@clock_ins%></h2>
                </div>
            </div>
        </div>
        <div class="widget btn-success style1 lazur-bg col-xs-10">
            <div class="row vertical-align">
                <div class="col-xs-12 text-center">
                    <h2 class="font-bold no-margins">Clock Outs: <%=@clock_outs%></h2>
                </div>
            </div>
        </div>
        <div class="widget btn-success style1 lazur-bg col-xs-10">
            <div class="row vertical-align">
                <div class="col-xs-12 text-center">
                    <h2 class="font-bold no-margins">Calls Made: <%=@calls.count%></h2>
                </div>
            </div>
        </div>
      <%if current_user.reminders.count > 0%>
        <small>You have <%=current_user.reminders.where('date > ?', Time.now).count%> reminders.</small>
        <%current_user.reminders.where('date > ?', Time.now).each do |r|%>
            <ul class="list-group clear-list m-t">
                <li class="list-group-item fist-item">
                    <span class="pull-right">
                        09:00 pm
                    </span>
                    <span class="label label-success">1</span> <%=r.reminder%>
                </li>
            </ul>
        <%end%>
      <%end%>
    </div>
    <div class="col-sm-6">
        <div class="flot-chart dashboard-chart">
            <div class="flot-chart-content" id="flot-dashboard-chart"></div>
        </div>
    </div>
    <%if current_user.call_number%>
      <div class="col-sm-3">
        <div class="widget style1 lazur-bg">
            <div class="row vertical-align">
                <div class="col-xs-2">
                    <i class="fa fa-phone fa-2x"></i>
                </div>
                <div class="col-xs-10 text-center">
                    <h2 class="font-bold no-margins"><%=current_user.call_number%></h2>
                </div>
            </div>
        </div>
      </div>
    <%else # red alert, your number isn't set yet%>
      <div class="col-sm-3">
        <div class="widget red-bg style1 lazur-bg">
            <div class="row vertical-align">
                <div class="col-xs-2">
                    <i class="fa fa-phone fa-2x"></i>
                </div>
                <div class="col-xs-10 text-center">
                    <h2 class="font-bold no-margins">No Number</h2>
                </div>
            </div>
        </div>
      </div>
    <%end%>
    <div class="col-sm-3">

    </div>

</div>





<div class="wrapper wrapper-content animated fadeInRight">
<div class="row">
<div class="col-lg-12">
<div class="ibox float-e-margins">
<div class="ibox-title">
    <h5>Caregiver Activity</h5>



    <div class="ibox-tools">
        <a class="collapse-link">
        </a>
        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
        </a>
        <ul class="dropdown-menu dropdown-user">
            <li>
                <a href="#">Config option 1</a>
            </li>
            <li>
                <a href="#">Config option 2</a>
            </li>
        </ul>
        <a class="close-link">
        </a>
    </div>
</div>
<div class="ibox-content">

<table class="table table-striped table-bordered table-hover dataTables-example">
<thead>
<tr>
    <th>Date</th>
    <th>Employee</th>
    <th>Client</th>
    <th>Phone Number</th>
    <th>Work Duration</th>
    <th>Log</th>
</tr>
</thead>
<tbody>
  <% @calls.each do |c| %>
    <tr class="gradeX">
        <td class="center"><div style="font-size:0; color:transparent;"><%= c.created_at%></div> <%=local_time(c.created_at)%></td>
        <%if c.caregiver%>
          <td><%= link_to "#{c.caregiver.name} / #{c.caregiver.employee_code}", caregiver_path(c.caregiver) %></td>
        <%else%>
          <td></td>
        <%end%>
        <%if c.client%>
          <td><%= link_to c.client.name, client_path(c.client) %></td>
        <%else%>
          <td></td>
        <%end%>

        <td class="center"><%=c.caller_number%></td>
        <%if c.duration%>
          <td><%=c.duration %></td>
        <%else%>
          <td></td>
        <%end%>

        <td class="center"><%=c.log_type%></td>

    </tr>
  <% end %>
</tbody>
<tfoot>
  <tr>
    <th>Date</th>
    <th>Employee</th>
    <th>Client</th>
    <th>Phone Number</th>
    <th>Work Duration</th>
    <th>Log</th>
  </tr>
</tfoot>
</table>

</div>
</div>
</div>
</div>

</div>











<div class="wrapper wrapper-content">
<div class="row animated fadeInRight">
    <div class="col-lg-12">
        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>Recent Activity</h5>
                <div class="ibox-tools">
                    <a class="collapse-link">
                        <i class="fa fa-chevron-up"></i>
                    </a>
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-wrench"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li>
                            <a href="#">Config option 1</a>
                        </li>
                        <li>
                            <a href="#">Config option 2</a>
                        </li>
                    </ul>
                    <a class="close-link">
                        <i class="fa fa-times"></i>
                    </a>
                </div>
            </div>

            <div class="ibox-content inspinia-timeline">

                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-briefcase"></i>
                            6:00 am
                            <br />
                            <small class="text-navy">2 hour ago</small>
                        </div>
                        <div class="col-xs-7 content no-top-border">
                            <p class="m-b-xs"><strong>Meeting</strong></p>

                            <p>
                                Conference on the sales results for the previous year. Monica please examine sales trends in marketing and products. Below please find the current status of the
                                sale.
                            </p>

                            <p><span data-diameter="40" class="updating-chart">5,3,9,6,5,9,7,3,5,2,5,3,9,6,5,9,4,7,3,2,9,8,7,4,5,1,2,9,5,4,7,2,7,7,3,5,2</span></p>
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-file-text"></i>
                            7:00 am
                            <br />
                            <small class="text-navy">3 hour ago</small>
                        </div>
                        <div class="col-xs-7 content">
                            <p class="m-b-xs"><strong>Send documents to Mike</strong></p>
                            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since.</p>
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-coffee"></i>
                            8:00 am
                            <br />
                        </div>
                        <div class="col-xs-7 content">
                            <p class="m-b-xs"><strong>Coffee Break</strong></p>
                            <p>
                                Go to shop and find some products.
                                Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-phone"></i>
                            11:00 am
                            <br />
                            <small class="text-navy">21 hour ago</small>
                        </div>
                        <div class="col-xs-7 content">
                            <p class="m-b-xs"><strong>Phone with Jeronimo</strong></p>
                            <p>
                                Lorem Ipsum has been the industry's standard dummy text ever since.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-user-md"></i>
                            09:00 pm
                            <br />
                            <small>21 hour ago</small>
                        </div>
                        <div class="col-xs-7 content">
                            <p class="m-b-xs"><strong>Go to the doctor dr Smith</strong></p>
                            <p>
                                Find some issue and go to doctor.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-user-md"></i>
                            11:10 pm
                        </div>
                        <div class="col-xs-7 content">
                            <p class="m-b-xs"><strong>Chat with Sandra</strong></p>
                            <p>
                                Lorem Ipsum has been the industry's standard dummy text ever since.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-comments"></i>
                            12:50 pm
                            <br />
                            <small class="text-navy">48 hour ago</small>
                        </div>
                        <div class="col-xs-7 content">
                            <p class="m-b-xs"><strong>Chat with Monica and Sandra</strong></p>
                            <p>
                                Web sites still in their infancy. Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).
                            </p>
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-phone"></i>
                            08:50 pm
                            <br />
                            <small class="text-navy">68 hour ago</small>
                        </div>
                        <div class="col-xs-7 content">
                            <p class="m-b-xs"><strong>Phone to James</strong></p>
                            <p>
                                Various versions have evolved over the years, sometimes by accident, sometimes on purpose (injected humour and the like).
                            </p>
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="row">
                        <div class="col-xs-3 date">
                            <i class="fa fa-file-text"></i>
                            7:00 am
                            <br />
                            <small class="text-navy">3 hour ago</small>
                        </div>
                        <div class="col-xs-7 content">
                            <p class="m-b-xs"><strong>Send documents to Mike</strong></p>
                            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since.</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
</div>



<div class="footer">
    <div class="pull-right">
        10 of <strong>50 Calls</strong> Free.
    </div>
    <div>
        <strong>Copyright</strong> Callia &copy; 2014-2017
    </div>
</div>
</div>

<% content_for :javascript do %>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js" /> -->

<script type="text/javascript">

$(function() {

    setTimeout(function() {
        toastr.options = {
            closeButton: true,
            progressBar: true,
            showMethod: 'slideDown',
            timeOut: 4000
        };

        toastr.success('<%=current_user.name%>', 'Welcome Back');

    }, 1300);

    $(".bar_dashboard").peity("bar", {
        fill: ["#1ab394", "#d7d7d7"],
        width: 100
    })

    $("#sparkline8").sparkline([5, 6, 7, 2, 0, 4, 2, 4, 5, 7, 2, 4, 12, 14, 4, 2, 14, 12, 7], {
        type: 'bar',
        barWidth: 8,
        height: '150px',
        barColor: '#1ab394',
        negBarColor: '#c6c6c6'
    });

    var updatingChart = $(".updating-chart").peity("line", { fill: '#1ab394', stroke: '#169c81', width: 64 })

    setInterval(function () {
        var random = Math.round(Math.random() * 10)
        var values = updatingChart.text().split(",")
        values.shift()
        values.push(random)

        updatingChart
                .text(values.join(","))
                .change()
    }, 1000);


    // var clock_ins = [[10,20]]//<%=Call.where(log_type: "Clocked In").where(user: current_user).where('created_at BETWEEN ? AND ?', start, the_end)%>
    var data1 = <%=@cin_hours%>; //<%=return_call_array(clock_ins)%>//
    var data2 = <%=@cout_hours%>;
    $("#flot-dashboard-chart").length && $.plot($("#flot-dashboard-chart"), [
        data1, data2
    ],
            {
                series: {
                    lines: {
                        show: false,
                        fill: true
                    },
                    splines: {
                        show: true,
                        tension: 0.4,
                        lineWidth: 1,
                        fill: 0.4
                    },
                    points: {
                        radius: 0,
                        show: true
                    },
                    shadowSize: 2
                },
                grid: {
                    hoverable: true,
                    clickable: true,
                    tickColor: "#d5d5d5",
                    borderWidth: 1,
                    color: '#d5d5d5'
                },
                colors: ["#1ab394", "#1C84C6"],
                xaxis: {
                },
                yaxis: {
                    ticks: 4
                },
                tooltip: false
            }
    );

    var doughnutData = {
        labels: ["App","Software","Laptop" ],
        datasets: [{
            data: [300,50,100],
            backgroundColor: ["#a3e1d4","#dedede","#9CC3DA"]
        }]
    } ;


    var doughnutOptions = {
        responsive: false,
        legend: {
            display: false
        }
    };


    var ctx4 = document.getElementById("doughnutChart").getContext("2d");
    new Chart(ctx4, {type: 'doughnut', data: doughnutData, options:doughnutOptions});

    var doughnutData = {
        labels: ["App","Software","Laptop" ],
        datasets: [{
            data: [70,27,85],
            backgroundColor: ["#a3e1d4","#dedede","#9CC3DA"]
        }]
    } ;


    var doughnutOptions = {
        responsive: false,
        legend: {
            display: false
        }
    };


    var ctx4 = document.getElementById("doughnutChart2").getContext("2d");
    new Chart(ctx4, {type: 'doughnut', data: doughnutData, options:doughnutOptions});

});

</script>


<% end %>
